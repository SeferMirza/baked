<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <ItemGroup>
    <Using Include="Baked" />
  </ItemGroup>

  <Target Name="Bake" AfterTargets="AfterBuild">
    <Exec Command="dotnet run $(ProjectPath) --no-build --no-start --bake -c $(Configuration)" Condition="'$(OS)' != 'Unix'" />
    <Exec Command="dotnet $(TargetPath) --no-build --no-start --bake -c $(Configuration)" Condition="'$(OS)' == 'Unix'" />
  </Target>

  <Target Name="CopyBakedFiles" AfterTargets="Publish">
    <ItemGroup>
        <GeneratedFilest Include="$(TargetDir)\$(ASPNETCORE_ENVIRONMENT)\*.*" />
    </ItemGroup>
    <Copy SourceFiles="@(GeneratedFilest)" DestinationFolder="$(PublishDir)\$(ASPNETCORE_ENVIRONMENT)" SkipUnchangedFiles="true" />
  </Target>

</Project>
